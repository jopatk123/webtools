<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>调试版本 - 我的工具箱</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .nav { margin-bottom: 20px; }
        .nav a { margin-right: 10px; padding: 10px; background: #007bff; color: white; text-decoration: none; }
        .nav a.active { background: #0056b3; }
        .tool-section { display: none; padding: 20px; border: 1px solid #ddd; }
        .tool-section.active { display: block; }
        button { padding: 10px; margin: 5px; background: #28a745; color: white; border: none; cursor: pointer; }
        input, textarea { padding: 5px; margin: 5px; width: 200px; }
        .debug { background: #f8f9fa; padding: 10px; margin: 10px 0; border-left: 3px solid #007bff; }
    </style>
</head>
<body>
    <h1>调试版本 - 我的工具箱</h1>
    
    <div class="debug">
        <h3>调试信息</h3>
        <div id="debugInfo">正在加载...</div>
    </div>
    
    <nav class="nav">
        <a href="#calculator" class="nav-link">计算器</a>
        <a href="#converters" class="nav-link">转换工具</a>
        <a href="#generators" class="nav-link">生成工具</a>
    </nav>
    
    <div id="calculator" class="tool-section">
        <h2>计算器</h2>
        <input type="text" id="calcDisplay" readonly>
        <div>
            <button data-value="1">1</button>
            <button data-value="2">2</button>
            <button data-value="3">3</button>
            <button data-value="+">+</button>
        </div>
        <div>
            <button id="calcClear">清除</button>
            <button id="calcEquals">=</button>
        </div>
    </div>
    
    <div id="converters" class="tool-section">
        <h2>转换工具</h2>
        <input type="text" id="hexInput" placeholder="#FF0000">
        <div id="colorResult"></div>
        <button id="convertColor">转换颜色</button>
    </div>
    
    <div id="generators" class="tool-section">
        <h2>生成工具</h2>
        <input type="range" id="passwordLength" min="4" max="20" value="8">
        <span id="lengthDisplay">8</span>
        <button id="generatePassword">生成密码</button>
        <input type="text" id="generatedPassword" readonly>
    </div>
    
    <script>
        // 调试信息
        const debugInfo = document.getElementById('debugInfo');
        
        function log(message) {
            console.log(message);
            debugInfo.innerHTML += '<div>' + new Date().toLocaleTimeString() + ': ' + message + '</div>';
        }
        
        log('开始初始化调试版本');
        
        // 简化的导航功能
        class SimpleNavigation {
            constructor() {
                this.init();
            }
            
            init() {
                log('初始化导航模块');
                this.bindEvents();
                this.showTool('calculator');
            }
            
            bindEvents() {
                const navLinks = document.querySelectorAll('.nav-link');
                log('找到导航链接数量: ' + navLinks.length);
                
                navLinks.forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = link.getAttribute('href').substring(1);
                        log('点击导航: ' + targetId);
                        this.showTool(targetId);
                    });
                });
            }
            
            showTool(toolId) {
                log('切换到工具: ' + toolId);
                
                // 隐藏所有区域
                document.querySelectorAll('.tool-section').forEach(s => {
                    s.classList.remove('active');
                });
                
                // 移除所有导航激活状态
                document.querySelectorAll('.nav-link').forEach(l => {
                    l.classList.remove('active');
                });
                
                // 显示目标区域
                const targetSection = document.getElementById(toolId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    log('成功显示区域: ' + toolId);
                } else {
                    log('错误: 找不到区域 ' + toolId);
                }
                
                // 激活对应导航
                const targetLink = document.querySelector(`a[href="#${toolId}"]`);
                if (targetLink) {
                    targetLink.classList.add('active');
                }
            }
        }
        
        // 简化的计算器
        class SimpleCalculator {
            constructor() {
                this.expression = '';
                this.init();
            }
            
            init() {
                log('初始化计算器模块');
                this.bindEvents();
            }
            
            bindEvents() {
                const calculatorSection = document.getElementById('calculator');
                if (calculatorSection) {
                    calculatorSection.addEventListener('click', (e) => {
                        const target = e.target;
                        if (target.tagName === 'BUTTON') {
                            const value = target.dataset.value;
                            if (value) {
                                log('计算器按钮点击: ' + value);
                                this.appendToCalc(value);
                            } else if (target.id === 'calcClear') {
                                log('清除按钮点击');
                                this.clear();
                            } else if (target.id === 'calcEquals') {
                                log('等号按钮点击');
                                this.calculate();
                            }
                        }
                    });
                } else {
                    log('错误: 找不到计算器区域');
                }
            }
            
            appendToCalc(value) {
                this.expression += value;
                document.getElementById('calcDisplay').value = this.expression;
            }
            
            clear() {
                this.expression = '';
                document.getElementById('calcDisplay').value = '';
            }
            
            calculate() {
                try {
                    const result = eval(this.expression);
                    document.getElementById('calcDisplay').value = result;
                    this.expression = result.toString();
                } catch (error) {
                    document.getElementById('calcDisplay').value = '错误';
                    this.expression = '';
                }
            }
        }
        
        // 简化的转换工具
        class SimpleConverters {
            constructor() {
                this.init();
            }
            
            init() {
                log('初始化转换工具模块');
                this.bindEvents();
            }
            
            bindEvents() {
                const convertBtn = document.getElementById('convertColor');
                if (convertBtn) {
                    convertBtn.addEventListener('click', () => {
                        log('颜色转换按钮点击');
                        this.convertColor();
                    });
                } else {
                    log('错误: 找不到颜色转换按钮');
                }
            }
            
            convertColor() {
                const hex = document.getElementById('hexInput').value;
                const result = document.getElementById('colorResult');
                result.textContent = '颜色: ' + hex + ' (转换功能正常)';
            }
        }
        
        // 简化的生成工具
        class SimpleGenerators {
            constructor() {
                this.init();
            }
            
            init() {
                log('初始化生成工具模块');
                this.bindEvents();
            }
            
            bindEvents() {
                const lengthSlider = document.getElementById('passwordLength');
                const generateBtn = document.getElementById('generatePassword');
                
                if (lengthSlider) {
                    lengthSlider.addEventListener('input', () => {
                        const length = lengthSlider.value;
                        document.getElementById('lengthDisplay').textContent = length;
                    });
                }
                
                if (generateBtn) {
                    generateBtn.addEventListener('click', () => {
                        log('生成密码按钮点击');
                        this.generatePassword();
                    });
                }
            }
            
            generatePassword() {
                const length = parseInt(document.getElementById('passwordLength').value);
                const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
                let password = '';
                for (let i = 0; i < length; i++) {
                    password += chars.charAt(Math.floor(Math.random() * chars.length));
                }
                document.getElementById('generatedPassword').value = password;
            }
        }
        
        // 初始化应用
        try {
            log('开始初始化应用模块');
            const navigation = new SimpleNavigation();
            const calculator = new SimpleCalculator();
            const converters = new SimpleConverters();
            const generators = new SimpleGenerators();
            log('所有模块初始化完成');
        } catch (error) {
            log('初始化错误: ' + error.message);
            console.error('初始化错误:', error);
        }
    </script>
</body>
</html>